## Проект 2

Запуск проекта в docker

```bash
docker compose up -d --build
```

### Задание 2.1

Имеется витрина dm.client, в которой содержится различная информация по клиентам банка. Заказчик сообщил, что в таблице имеются дубли, которые нужно устранить.

Необходимо подготовить запрос, по которому можно обнаружить все дубли в витрине и удалить их.

Схема витрины:

У данной таблицы имеется составной ключ, который состоит из двух полей, по которым можно выявить уникальную строку:

- client_rk – уникальный код клиента

- effective_from_date – дата начала действия записи

[./sql/delete_duplicates.sql](./sql/delete_duplicates.sql) - скрипт для очистки дублей из витрины dm.client

### Задание 2.2

Имеется витрина dm.loan_holiday_info, которая содержит информацию по кредитным каникулам, сделке и продукте, который был предоставлен клиенту в рамках сделки. После проверки качества данных выявилась проблема отсутствия некоторого количества записей в источниках витрины для некоторых периодов эффективности строк.

Источниками для данной витрины являются 3 таблицы:

- rd.deal – информация по сделкам клиентов

- rd.loan_holiday – информация о кредитных каникулах: дата начала, конца, тип кредитных каникул

- rd.product – информация о продуктах банка, которые он предоставляет

При формировании витрины был подготовлен прототип витрины, по которому она собирается, loan_holiday_info_prototype.sql.

Также, источник, из которого были загружены данные сущности на слой rd, предоставил актуальные выгрузки имеющихся у них данных в формате csv.

Необходимо проанализировать витрину, актуальное состояние таблиц-источников витрины и определить, по каким датам эффективности (effective_from_date или effective_to_date) отсутствуют строки и определить, какой способ загрузки новых данных подойдет: полная перегрузка таблицы или загрузка части данных.

Для загрузки данных на слой RD необходимо воспользоваться аналогичным методом загрузки данных из CSV файла в БД, которым Вы пользовались в первом задании. После того, как данные будут успешно загружены, необходимо написать процедуру, которая будет повторять шаги из прототипа для выполнения перегрузки данных в витрину.

[./sql/refresh_loan_holiday_info.sql](./sql/refresh_loan_holiday_info.sql) - процедура пересчета витрины

[./scripts/task_2_2_solutions.py](./scripts/task_2_2_solutions.py) - скрипт решения

[./scripts/TASK_2_2_README.md](./scripts/TASK_2_2_README.md) - описание решения